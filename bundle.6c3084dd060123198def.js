(self.webpackChunkspark_adhd_rn=self.webpackChunkspark_adhd_rn||[]).push([[728],{26216(e,t,r){var n=r(18772);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=n(r(16578)),a=n(r(26007)),s=n(r(66584)),i=r(8747),l=["task","event","reminder","thought","worry","idea"],u=["high","medium","low"];function c(e){if(!e||"object"!==(0,s.default)(e))return!1;var t=e;return"string"==typeof t.text&&l.includes(t.category)&&u.includes(t.priority)}function d(e){if(!e||"object"!==(0,s.default)(e))throw new Error("Invalid AI sort response payload.");var t=e;if(!Array.isArray(t.sorted)||!t.sorted.every(c))throw new Error("Invalid AI sort response schema.");return{sorted:t.sorted}}var f={sortItems:function(e,t){return(0,a.default)(o.default.mark(function r(){var n,a,s,l;return o.default.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(0!==(n=e.map(function(e){return e.trim()}).filter(Boolean).slice(0,100)).length){r.next=1;break}return r.abrupt("return",[]);case 1:return r.next=2,fetch("".concat(i.config.apiBaseUrl,"/api/sort"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({items:n,timezone:t})});case 2:return a=r.sent,r.next=3,a.json();case 3:if(s=r.sent,a.ok){r.next=4;break}throw l=s&&"string"==typeof s.error?s.error:"Unable to sort items right now.",new Error(l);case 4:return r.abrupt("return",d(s).sorted);case 5:case"end":return r.stop()}},r)}))()}};t.default=f},42745(e,t,r){var n=r(18772);Object.defineProperty(t,"__esModule",{value:!0}),t.normalizeMicroSteps=t.getTaskProgressSummary=t.ensureSingleNext=t.advanceTaskProgress=void 0;var o=n(r(51750)),a=n(r(3791)),s=r(15547);function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function l(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach(function(t){(0,a.default)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var u=t.ensureSingleNext=function(e){var t=!1,r=!1,n=e.map(function(e){if("in_progress"===e.status&&(r=!0),"next"===e.status){if(t)return l(l({},e),{},{status:"new"});t=!0}return e});if(!t&&!r&&n.length>0){var o=n.findIndex(function(e){return"new"===e.status}),a=o>=0?o:n.findIndex(function(e){return"done"!==e.status});a>=0&&(n[a]=l(l({},n[a]),{},{status:"next"}))}return n};t.advanceTaskProgress=function(e){if(e.completed||0===e.microSteps.length)return e;var t=(0,o.default)(e.microSteps),r=t.findIndex(function(e){return"in_progress"===e.status});if(r>=0)t[r]=l(l({},t[r]),{},{status:"done"});else{var n=t.findIndex(function(e){return"next"===e.status}),a=n>=0?n:t.findIndex(function(e){return"new"===e.status});a>=0&&(t[a]=l(l({},t[a]),{},{status:"in_progress"}))}var s=u(t),i=s.every(function(e){return"done"===e.status});return l(l({},e),{},{microSteps:s,completed:i})},t.getTaskProgressSummary=function(e){var t=e.filter(function(e){return"done"===e.status}).length;return"".concat(t,"/").concat(e.length," DONE")},t.normalizeMicroSteps=function(e){if(!Array.isArray(e)||0===e.length)return[];var t=e.map(function(e,t){if("string"==typeof e)return{id:(0,s.generateId)(),text:e,status:0===t?"next":"new"};var r="new"===e.status||"next"===e.status||"in_progress"===e.status||"done"===e.status?e.status:0===t?"next":"new";return{id:e.id||(0,s.generateId)(),text:e.text,status:r}});return u(t)}},51728(e,t,r){var n=r(18772),o=r(66584);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=n(r(16578)),s=n(r(51750)),i=n(r(3791)),l=n(r(26007)),u=n(r(58361)),c=S(r(25602)),d=r(71582),f=r(20662),m=n(r(40629)),p=n(r(93400)),g=n(r(81731)),b=S(r(75128)),y=n(r(41262)),_=n(r(26216)),k=r(15547),T=r(42745),x=r(56045),h=r(46586),N=this,v="C:\\Users\\Steve\\OneDrive\\Desktop\\Github Repos\\spark-adhd-backup\\src\\screens\\BrainDumpScreen.tsx";function S(e,t){if("function"==typeof WeakMap)var r=new WeakMap,n=new WeakMap;return(S=function(e,t){if(!t&&e&&e.__esModule)return e;var a,s,i={__proto__:null,default:e};if(null===e||"object"!=o(e)&&"function"!=typeof e)return i;if(a=t?n:r){if(a.has(e))return a.get(e);a.set(e,i)}for(var l in e)"default"!==l&&{}.hasOwnProperty.call(e,l)&&((s=(a=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,l))&&(s.get||s.set)?a(i,l,s):i[l]=e[l]);return i})(e,t)}function w(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function E(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?w(Object(r),!0).forEach(function(t){(0,i.default)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):w(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var A={top:h.Tokens.spacing[4],bottom:h.Tokens.spacing[4],left:h.Tokens.spacing[4],right:h.Tokens.spacing[4]},I=["task","event","reminder","worry","thought","idea"],O=function(e){return e.split(/\r?\n|[.;]+/).map(function(e){return e.replace(/^[-*\d.)\s]+/,"").trim()}).filter(Boolean).slice(0,50)},R=function(e){if("task"!==e.category&&"reminder"!==e.category&&"event"!==e.category)return null;var t=e.text.trim();if(!t)return null;var r=["Open this task and start with a 2-minute first step"];return e.dueDate&&r.push("Check due date: ".concat(e.dueDate)),e.start&&r.push("Schedule window starts: ".concat(e.start)),{id:(0,k.generateId)(),text:t,completed:!1,microSteps:(0,T.normalizeMicroSteps)(r)}},P=d.StyleSheet.create({container:{flex:1,backgroundColor:h.Tokens.colors.neutral.darkest},centerContainer:{flex:1,alignItems:"center"},contentWrapper:{flex:1,width:"100%",maxWidth:h.Tokens.layout.maxWidth.prose,padding:h.Tokens.spacing[4]},header:{marginBottom:h.Tokens.spacing[6],borderBottomWidth:1,borderColor:h.Tokens.colors.neutral.border,paddingBottom:h.Tokens.spacing[2],flexDirection:"row",alignItems:"center",justifyContent:"space-between"},title:{fontFamily:h.Tokens.type.fontFamily.mono,fontSize:h.Tokens.type.lg,fontWeight:"700",color:h.Tokens.colors.text.primary,letterSpacing:1,textTransform:"uppercase"},headerLine:{flex:1,height:1,backgroundColor:h.Tokens.colors.neutral.dark,marginLeft:h.Tokens.spacing[4]},inputSection:{flexDirection:"row",marginBottom:h.Tokens.spacing[6],gap:h.Tokens.spacing[3],alignItems:"center"},inputWrapper:E({flex:1,backgroundColor:h.Tokens.colors.neutral.darker,borderRadius:h.Tokens.radii.none,borderWidth:1,borderColor:h.Tokens.colors.neutral.border,minHeight:48,justifyContent:"center"},d.Platform.select({web:{transition:"border-color 0.2s ease"}})),inputWrapperFocused:{borderColor:h.Tokens.colors.text.primary},input:E({paddingHorizontal:h.Tokens.spacing[3],color:h.Tokens.colors.text.primary,fontFamily:h.Tokens.type.fontFamily.mono,fontSize:h.Tokens.type.sm,minHeight:48,textAlignVertical:"center",paddingVertical:0},d.Platform.select({web:{outlineStyle:"none"}})),addButton:{minHeight:48,width:60,justifyContent:"center",alignItems:"center",borderRadius:h.Tokens.radii.none},actionsBar:{flexDirection:"row",justifyContent:"space-between",marginBottom:h.Tokens.spacing[4],paddingHorizontal:h.Tokens.spacing[2],alignItems:"center"},actionsRight:{flexDirection:"row",alignItems:"center",gap:h.Tokens.spacing[4]},actionButton:E({paddingVertical:4,paddingHorizontal:8,borderRadius:h.Tokens.radii.none,borderWidth:1,borderColor:h.Tokens.colors.neutral.border},d.Platform.select({web:{transition:"all 0.2s ease"}})),actionButtonDisabled:{opacity:.5,pointerEvents:"none"},clearHovered:{backgroundColor:h.Tokens.colors.neutral.dark},clearPressed:{opacity:.7},countText:{fontFamily:h.Tokens.type.fontFamily.mono,color:h.Tokens.colors.text.secondary,fontSize:h.Tokens.type.xs,fontWeight:"700",letterSpacing:1},clearText:{fontFamily:h.Tokens.type.fontFamily.mono,color:h.Tokens.colors.brand[500],fontSize:h.Tokens.type.xs,fontWeight:"700",letterSpacing:1},aiSortText:{fontFamily:h.Tokens.type.fontFamily.mono,color:h.Tokens.colors.text.primary,fontSize:h.Tokens.type.xs,fontWeight:"700",letterSpacing:1},sortedSection:{marginTop:h.Tokens.spacing[4],marginBottom:h.Tokens.spacing[6],padding:h.Tokens.spacing[4],backgroundColor:h.Tokens.colors.neutral.darker,borderRadius:h.Tokens.radii.none,borderWidth:1,borderStyle:"dashed",borderColor:h.Tokens.colors.neutral.border},sortedTitle:{fontFamily:h.Tokens.type.fontFamily.mono,fontSize:h.Tokens.type.xs,fontWeight:"700",color:h.Tokens.colors.text.primary,marginBottom:h.Tokens.spacing[4],letterSpacing:1,textTransform:"uppercase"},sortedGroup:{marginBottom:h.Tokens.spacing[4]},sortedCategory:{fontFamily:h.Tokens.type.fontFamily.mono,fontSize:h.Tokens.type.xs,fontWeight:"700",color:h.Tokens.colors.text.secondary,textTransform:"uppercase",letterSpacing:1,marginBottom:h.Tokens.spacing[2],opacity:.9},sortedItemRow:{flexDirection:"row",justifyContent:"space-between",alignItems:"flex-start",paddingVertical:4,marginBottom:0},sortedItemText:{flex:1,fontFamily:h.Tokens.type.fontFamily.mono,fontSize:h.Tokens.type.xs,color:h.Tokens.colors.text.secondary,lineHeight:1.5*h.Tokens.type.sm,marginRight:h.Tokens.spacing[3]},priorityBadge:{paddingHorizontal:6,paddingVertical:0,borderRadius:h.Tokens.radii.none,minWidth:40,alignItems:"center",borderWidth:1,borderColor:h.Tokens.colors.neutral.border},priorityText:{fontFamily:h.Tokens.type.fontFamily.mono,fontSize:h.Tokens.type.xxs,fontWeight:"700",textTransform:"uppercase",color:h.Tokens.colors.text.primary},priorityHigh:{backgroundColor:h.Tokens.colors.brand[500],borderColor:h.Tokens.colors.brand[500]},priorityMedium:{backgroundColor:h.Tokens.colors.neutral.border},priorityLow:{backgroundColor:h.Tokens.colors.neutral.dark},listContent:{paddingBottom:120},item:E({backgroundColor:h.Tokens.colors.neutral.darkest,borderRadius:h.Tokens.radii.none,paddingHorizontal:h.Tokens.spacing[4],paddingVertical:h.Tokens.spacing[3],marginBottom:-1,flexDirection:"row",justifyContent:"space-between",alignItems:"center",borderWidth:1,borderColor:h.Tokens.colors.neutral.border,minHeight:48},d.Platform.select({web:{transition:"all 0.2s ease"}})),itemText:{flex:1,color:h.Tokens.colors.text.primary,fontFamily:h.Tokens.type.fontFamily.mono,fontSize:h.Tokens.type.sm,lineHeight:1.2*h.Tokens.type.base,marginRight:h.Tokens.spacing[4]},deleteButton:E({padding:0,borderRadius:h.Tokens.radii.none,width:32,height:32,alignItems:"center",justifyContent:"center"},d.Platform.select({web:{transition:"all 0.2s ease"}})),deleteButtonHovered:{backgroundColor:h.Tokens.colors.neutral.dark},deleteButtonPressed:{backgroundColor:h.Tokens.colors.neutral.border},deleteText:{color:h.Tokens.colors.text.secondary,fontSize:h.Tokens.type.lg,fontWeight:"300",marginTop:-2},emptyState:{alignItems:"center",marginTop:h.Tokens.spacing[12],opacity:.3},emptyIcon:{fontSize:h.Tokens.type["5xl"],marginBottom:h.Tokens.spacing[4]},emptyText:{fontFamily:h.Tokens.type.fontFamily.mono,color:h.Tokens.colors.text.secondary,fontSize:h.Tokens.type.sm,letterSpacing:2,textTransform:"uppercase"},emptyAction:{marginTop:h.Tokens.spacing[6]},recordSection:{alignItems:"center",marginBottom:h.Tokens.spacing[6]},recordButton:E({flexDirection:"row",alignItems:"center",backgroundColor:h.Tokens.colors.neutral.darkest,paddingHorizontal:h.Tokens.spacing[4],paddingVertical:h.Tokens.spacing[2],borderRadius:h.Tokens.radii.none,borderWidth:1,borderColor:h.Tokens.colors.neutral.border,minWidth:140,minHeight:48,justifyContent:"center"},d.Platform.select({web:{transition:"all 0.2s ease",cursor:"pointer"}})),recordButtonHovered:{borderColor:h.Tokens.colors.text.primary},recordButtonActive:{backgroundColor:h.Tokens.colors.brand[500],borderColor:h.Tokens.colors.brand[500]},recordButtonProcessing:{opacity:.5,backgroundColor:h.Tokens.colors.neutral.dark},recordButtonPressed:{opacity:.8},recordIcon:{fontSize:h.Tokens.type.base,marginRight:h.Tokens.spacing[2],color:h.Tokens.colors.text.primary},recordText:{fontFamily:h.Tokens.type.fontFamily.mono,fontSize:h.Tokens.type.xs,fontWeight:"700",color:h.Tokens.colors.text.primary,letterSpacing:1},errorText:{fontFamily:h.Tokens.type.fontFamily.mono,fontSize:h.Tokens.type.xs,color:h.Tokens.colors.brand[500],marginTop:h.Tokens.spacing[2],textAlign:"center"},loadingContainer:{padding:h.Tokens.spacing[8],alignItems:"center",gap:h.Tokens.spacing[4]},guideBanner:{backgroundColor:h.Tokens.colors.neutral.dark,borderWidth:1,borderColor:h.Tokens.colors.brand[500],padding:h.Tokens.spacing[3],marginBottom:h.Tokens.spacing[6],flexDirection:"row",alignItems:"center",justifyContent:"space-between",gap:h.Tokens.spacing[4]},guideContent:{flex:1},guideTitle:{fontFamily:h.Tokens.type.fontFamily.mono,fontSize:h.Tokens.type.xs,fontWeight:"700",color:h.Tokens.colors.brand[500],marginBottom:h.Tokens.spacing[1],letterSpacing:1},guideText:{fontFamily:h.Tokens.type.fontFamily.mono,fontSize:h.Tokens.type.xs,color:h.Tokens.colors.text.primary},guideButton:{paddingVertical:4,paddingHorizontal:8,borderWidth:1,borderColor:h.Tokens.colors.neutral.border,backgroundColor:h.Tokens.colors.neutral.darkest},guideButtonPressed:{backgroundColor:h.Tokens.colors.neutral.darker},guideButtonText:{fontFamily:h.Tokens.type.fontFamily.mono,fontSize:h.Tokens.type.xxs,fontWeight:"700",color:h.Tokens.colors.text.primary,textTransform:"uppercase"},loadingText:{fontFamily:h.Tokens.type.fontFamily.mono,fontSize:h.Tokens.type.sm,color:h.Tokens.colors.text.secondary,letterSpacing:1,textTransform:"uppercase"}});t.default=function(){var e,t,r=(0,f.useRoute)(),n=(0,c.useState)(""),o=(0,u.default)(n,2),i=o[0],T=o[1],S=(0,c.useState)([]),w=(0,u.default)(S,2),C=w[0],B=w[1],F=(0,c.useState)(!1),D=(0,u.default)(F,2),j=D[0],L=D[1],z=(0,c.useState)("idle"),W=(0,u.default)(z,2),H=W[0],V=W[1],M=(0,c.useState)(null),G=(0,u.default)(M,2),U=G[0],Y=G[1],K=(0,c.useState)(!1),J=(0,u.default)(K,2),q=J[0],Q=J[1],X=(0,c.useState)(!0),Z=(0,u.default)(X,2),$=Z[0],ee=Z[1],te=(0,c.useState)(null),re=(0,u.default)(te,2),ne=re[0],oe=re[1],ae=(0,c.useState)([]),se=(0,u.default)(ae,2),ie=se[0],le=se[1],ue=(0,c.useState)(!1),ce=(0,u.default)(ue,2),de=ce[0],fe=ce[1],me=(0,c.useState)(!0),pe=(0,u.default)(me,2),ge=pe[0],be=pe[1],ye=(0,c.useRef)(!1),_e=(0,c.useRef)(!1),ke=(0,c.useRef)(null),Te=(0,c.useRef)(null),xe=(0,c.useRef)(0),he=(0,c.useRef)(null),Ne=(t=(0,l.default)(a.default.mark(function e(){var t,r,n,o,s,i;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=1,Promise.all([m.default.getJSON(m.default.STORAGE_KEYS.brainDump),m.default.getJSON(m.default.STORAGE_KEYS.firstSuccessGuideState)]);case 1:t=e.sent,r=(0,u.default)(t,2),n=r[0],o=r[1],be(!!o&&!!o.brainDumpDismissed),n&&Array.isArray(n)&&(s=n.filter(function(e){return Boolean((null==e?void 0:e.id)&&(null==e?void 0:e.text)&&(null==e?void 0:e.createdAt))}),d.LayoutAnimation.configureNext(d.LayoutAnimation.Presets.easeInEaseOut),B(s)),e.next=3;break;case 2:e.prev=2,i=e.catch(0),console.error("Failed to load items",i);case 3:return e.prev=3,ee(!1),e.finish(3);case 4:case"end":return e.stop()}},e,null,[[0,2,3,4]])})),function(){return t.apply(this,arguments)});(0,c.useEffect)(function(){"android"===d.Platform.OS&&d.UIManager.setLayoutAnimationEnabledExperimental&&d.UIManager.setLayoutAnimationEnabledExperimental(!0),Ne()},[]),(0,c.useEffect)(function(){return ke.current&&clearTimeout(ke.current),ke.current=setTimeout(function(){m.default.setJSON(m.default.STORAGE_KEYS.brainDump,C).catch(function(e){console.error("Failed to persist brain dump items:",e)})},300),C.length!==xe.current&&(Te.current&&clearTimeout(Te.current),Te.current=setTimeout(function(){y.default.updateCount(C.length),xe.current=C.length},250)),function(){ke.current&&clearTimeout(ke.current),Te.current&&clearTimeout(Te.current)}},[C]);var ve,Se,we,Ee=(ve=(0,l.default)(a.default.mark(function e(){var t,r,n,o,s;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return d.LayoutAnimation.configureNext(d.LayoutAnimation.Presets.easeInEaseOut),fe(!1),be(!0),e.next=1,m.default.getJSON(m.default.STORAGE_KEYS.firstSuccessGuideState);case 1:if(o=t=e.sent,!(n=null!==o)){e.next=2;break}n=void 0!==t;case 2:if(!n){e.next=3;break}s=t,e.next=4;break;case 3:s={};case 4:return r=s,e.next=5,m.default.setJSON(m.default.STORAGE_KEYS.firstSuccessGuideState,E(E({},r),{},{brainDumpDismissed:!0}));case 5:case"end":return e.stop()}},e)})),function(){return ve.apply(this,arguments)}),Ae=function(){if(i.trim()){d.LayoutAnimation.configureNext(d.LayoutAnimation.Presets.easeInEaseOut);var e={id:(0,k.generateId)(),text:i.trim(),createdAt:(new Date).toISOString(),source:"text"};B(function(t){var r=[e].concat((0,s.default)(t));return ge||de||(p.default.track("brain_dump_first_item_added"),fe(!0)),r}),T(""),le([]),oe(null)}},Ie=(0,c.useCallback)((Se=(0,l.default)(a.default.mark(function e(t){var r,n,o,i,l,u,c;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,m.default.getJSON(m.default.STORAGE_KEYS.tasks);case 1:if(u=r=e.sent,!(l=null!==u)){e.next=2;break}l=void 0!==r;case 2:if(!l){e.next=3;break}c=r,e.next=4;break;case 3:c=[];case 4:if(n=c,o=new Set(n.map(function(e){return e.text.trim().toLowerCase()})),i=[],t.forEach(function(e){var t=R(e);if(t){var r=t.text.trim().toLowerCase();o.has(r)||(o.add(r),i.push(t))}}),0!==i.length){e.next=5;break}return e.abrupt("return",0);case 5:return e.next=6,m.default.setJSON(m.default.STORAGE_KEYS.tasks,[].concat((0,s.default)(n),i));case 6:return e.abrupt("return",i.length);case 7:case"end":return e.stop()}},e)})),function(e){return Se.apply(this,arguments)}),[]),Oe=(0,c.useCallback)((we=(0,l.default)(a.default.mark(function e(t){var r,n,o,s,i;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==t.length){e.next=1;break}return e.abrupt("return");case 1:return e.next=2,_.default.sortItems(t);case 2:return r=e.sent,le(r),e.next=3,Promise.all([Ie(r),b.GoogleTasksSyncService.syncSortedItemsToGoogle(r)]);case 3:n=e.sent,o=(0,u.default)(n,2),s=o[0],(i=o[1]).authRequired?oe(i.errorMessage||"Google sign-in required to sync Tasks and Calendar exports."):i.errorMessage&&oe(i.errorMessage),(s>0||i.createdTasks>0||i.createdEvents>0)&&(oe(null),d.AccessibilityInfo.announceForAccessibility("Tasks synced and suggestions saved."));case 4:case"end":return e.stop()}},e)})),function(e){return we.apply(this,arguments)}),[Ie]),Re=(0,c.useCallback)((0,l.default)(a.default.mark(function e(){var t,r,n,o,i,l;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("idle"===H&&(_e.current=!!U),Y(null),"idle"!==H){e.next=2;break}return e.next=1,g.default.startRecording();case 1:e.sent?V("recording"):Y("Could not start recording. Check microphone permissions."),e.next=12;break;case 2:if("recording"!==H){e.next=12;break}return V("processing"),e.next=3,g.default.stopRecording();case 3:if(t=e.sent){e.next=4;break}return Y("Recording failed."),V("idle"),e.abrupt("return");case 4:return e.next=5,b.default.transcribe(t.uri);case 5:if(!(r=e.sent).success||!r.transcription){e.next=10;break}if(_e.current&&(p.default.track("brain_dump_recovery_after_error"),_e.current=!1),d.LayoutAnimation.configureNext(d.LayoutAnimation.Presets.easeInEaseOut),n={id:(0,k.generateId)(),text:r.transcription,createdAt:(new Date).toISOString(),source:"audio",audioPath:t.uri},B(function(e){var t=[n].concat((0,s.default)(e));return ge||de||(p.default.track("brain_dump_first_item_added"),fe(!0)),t}),!((o=O(r.transcription)).length>0)){e.next=9;break}return e.prev=6,e.next=7,Oe(o);case 7:oe(null),e.next=9;break;case 8:e.prev=8,l=e.catch(6),i=l instanceof Error?l.message:"Failed to sync transcription suggestions.",oe(i);case 9:e.next=11;break;case 10:Y(r.error||"Transcription failed.");case 11:V("idle");case 12:case"end":return e.stop()}},e,null,[[6,8]])})),[ge,U,H,Oe,de]);(0,c.useEffect)(function(){var e;null!==(e=r.params)&&void 0!==e&&e.autoRecord&&!ye.current&&(ye.current=!0,Re())},[Re,null===(e=r.params)||void 0===e?void 0:e.autoRecord]);var Pe,Ce=(Pe=(0,l.default)(a.default.mark(function e(){var t;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return oe(null),Q(!0),e.prev=1,e.next=2,Oe(C.map(function(e){return e.text}));case 2:d.AccessibilityInfo.announceForAccessibility("AI suggestions updated."),e.next=4;break;case 3:e.prev=3,t=e.catch(1),oe(t instanceof Error?t.message:"AI sort is currently unavailable."),le([]);case 4:return e.prev=4,Q(!1),e.finish(4);case 5:case"end":return e.stop()}},e,null,[[1,3,4,5]])})),function(){return Pe.apply(this,arguments)}),Be=(0,c.useMemo)(function(){var e=new Map;return ie.forEach(function(t){var r,n=null!==(r=e.get(t.category))&&void 0!==r?r:[];n.push(t),e.set(t.category,n)}),I.map(function(t){var r;return{category:t,items:null!==(r=e.get(t))&&void 0!==r?r:[]}}).filter(function(e){return e.items.length>0})},[ie]);return c.default.createElement(d.SafeAreaView,{style:P.container,__self:N,__source:{fileName:v,lineNumber:518,columnNumber:5}},c.default.createElement(d.View,{style:P.centerContainer,__self:N,__source:{fileName:v,lineNumber:519,columnNumber:7}},c.default.createElement(d.View,{style:P.contentWrapper,__self:N,__source:{fileName:v,lineNumber:520,columnNumber:9}},c.default.createElement(d.View,{style:P.header,__self:N,__source:{fileName:v,lineNumber:521,columnNumber:11}},c.default.createElement(d.Text,{style:P.title,__self:N,__source:{fileName:v,lineNumber:522,columnNumber:13}},"BRAIN_DUMP"),c.default.createElement(d.View,{style:P.headerLine,__self:N,__source:{fileName:v,lineNumber:523,columnNumber:13}})),c.default.createElement(d.View,{style:P.inputSection,__self:N,__source:{fileName:v,lineNumber:526,columnNumber:11}},c.default.createElement(d.View,{style:[P.inputWrapper,j&&P.inputWrapperFocused],__self:N,__source:{fileName:v,lineNumber:527,columnNumber:13}},c.default.createElement(d.TextInput,{ref:he,style:P.input,placeholder:"> INPUT_DATA...",placeholderTextColor:h.Tokens.colors.text.placeholder,accessibilityLabel:"Add a brain dump item",accessibilityHint:"Type a thought and press Add",value:i,onChangeText:T,onSubmitEditing:Ae,onFocus:function(){return L(!0)},onBlur:function(){return L(!1)},multiline:!1,returnKeyType:"done",blurOnSubmit:!0,__self:N,__source:{fileName:v,lineNumber:533,columnNumber:15}})),c.default.createElement(x.LinearButton,{title:"+",onPress:Ae,size:"lg",style:P.addButton,__self:N,__source:{fileName:v,lineNumber:550,columnNumber:13}})),de&&c.default.createElement(d.View,{style:P.guideBanner,__self:N,__source:{fileName:v,lineNumber:559,columnNumber:13}},c.default.createElement(d.View,{style:P.guideContent,__self:N,__source:{fileName:v,lineNumber:560,columnNumber:15}},c.default.createElement(d.Text,{style:P.guideTitle,__self:N,__source:{fileName:v,lineNumber:561,columnNumber:17}},"DATA_CAPTURED."),c.default.createElement(d.Text,{style:P.guideText,__self:N,__source:{fileName:v,lineNumber:562,columnNumber:17}},"NEXT: PROCESS_IN_FOG_CUTTER.")),c.default.createElement(d.Pressable,{onPress:Ee,style:function(e){var t=e.pressed;return[P.guideButton,t&&P.guideButtonPressed]},accessibilityRole:"button",accessibilityLabel:"Dismiss guidance",__self:N,__source:{fileName:v,lineNumber:566,columnNumber:15}},c.default.createElement(d.Text,{style:P.guideButtonText,__self:N,__source:{fileName:v,lineNumber:575,columnNumber:17}},"ACK"))),c.default.createElement(d.View,{style:P.recordSection,__self:N,__source:{fileName:v,lineNumber:581,columnNumber:11}},c.default.createElement(d.Pressable,{onPress:Re,disabled:"processing"===H,accessibilityRole:"button",accessibilityLabel:"recording"===H?"Stop recording":"Start recording",accessibilityHint:"Records voice and converts it to a task item",style:function(e){var t=e.pressed,r=e.hovered;return[P.recordButton,r&&P.recordButtonHovered,"recording"===H&&P.recordButtonActive,"processing"===H&&P.recordButtonProcessing,t&&P.recordButtonPressed]},__self:N,__source:{fileName:v,lineNumber:582,columnNumber:13}},"processing"===H?c.default.createElement(d.ActivityIndicator,{size:"small",color:h.Tokens.colors.text.primary,__self:N,__source:{fileName:v,lineNumber:608,columnNumber:17}}):c.default.createElement(d.Text,{style:P.recordIcon,__self:N,__source:{fileName:v,lineNumber:613,columnNumber:17}},"recording"===H?"‚èπÔ∏è":"üéôÔ∏è"),c.default.createElement(d.Text,{style:P.recordText,__self:N,__source:{fileName:v,lineNumber:617,columnNumber:15}},"idle"===H&&"VOICE_INPUT","recording"===H&&"STOP_REC","processing"===H&&"PROCESSING...")),U&&c.default.createElement(d.Text,{style:P.errorText,__self:N,__source:{fileName:v,lineNumber:624,columnNumber:15}},U)),$?c.default.createElement(d.View,{style:P.loadingContainer,__self:N,__source:{fileName:v,lineNumber:629,columnNumber:13}},c.default.createElement(d.ActivityIndicator,{size:"small",color:h.Tokens.colors.brand[500],__self:N,__source:{fileName:v,lineNumber:630,columnNumber:15}}),c.default.createElement(d.Text,{style:P.loadingText,__self:N,__source:{fileName:v,lineNumber:634,columnNumber:15}},"LOADING...")):C.length>0?c.default.createElement(d.View,{style:P.actionsBar,__self:N,__source:{fileName:v,lineNumber:637,columnNumber:13}},c.default.createElement(d.Text,{style:P.countText,__self:N,__source:{fileName:v,lineNumber:638,columnNumber:15}},C.length," ITEMS"),c.default.createElement(d.View,{style:P.actionsRight,__self:N,__source:{fileName:v,lineNumber:639,columnNumber:15}},c.default.createElement(d.Pressable,{onPress:Ce,disabled:q,accessibilityRole:"button",accessibilityLabel:"AI sort",accessibilityHint:"Sorts and groups items using AI suggestions",style:function(e){var t=e.pressed,r=e.hovered;return[P.actionButton,r&&P.clearHovered,t&&P.clearPressed,q&&P.actionButtonDisabled]},__self:N,__source:{fileName:v,lineNumber:640,columnNumber:17}},c.default.createElement(d.Text,{style:P.aiSortText,__self:N,__source:{fileName:v,lineNumber:659,columnNumber:19}},q?"SORTING...":"AI_SORT")),c.default.createElement(d.Pressable,{onPress:function(){d.Alert.alert("CLEAR_DATA?","IRREVERSIBLE_ACTION.",[{text:"ABORT",style:"cancel"},{text:"CONFIRM",style:"destructive",onPress:function(){d.LayoutAnimation.configureNext(d.LayoutAnimation.Presets.easeInEaseOut),B([]),le([]),oe(null),d.AccessibilityInfo.announceForAccessibility("All items cleared.")}}],{cancelable:!0})},accessibilityRole:"button",accessibilityLabel:"Clear all items",accessibilityHint:"Opens a confirmation to remove all items",style:function(e){var t=e.pressed,r=e.hovered;return[P.actionButton,r&&P.clearHovered,t&&P.clearPressed]},__self:N,__source:{fileName:v,lineNumber:663,columnNumber:17}},c.default.createElement(d.Text,{style:P.clearText,__self:N,__source:{fileName:v,lineNumber:680,columnNumber:19}},"CLEAR")))):null,ne&&c.default.createElement(d.Text,{style:P.errorText,__self:N,__source:{fileName:v,lineNumber:686,columnNumber:28}},ne),!$&&Be.length>0&&c.default.createElement(d.View,{style:P.sortedSection,__self:N,__source:{fileName:v,lineNumber:689,columnNumber:13}},c.default.createElement(d.Text,{style:P.sortedTitle,__self:N,__source:{fileName:v,lineNumber:690,columnNumber:15}},"AI_ANALYSIS"),Be.map(function(e){var t=e.category,r=e.items;return c.default.createElement(d.View,{key:t,style:P.sortedGroup,__self:N,__source:{fileName:v,lineNumber:692,columnNumber:17}},c.default.createElement(d.Text,{style:P.sortedCategory,__self:N,__source:{fileName:v,lineNumber:693,columnNumber:19}},t.toUpperCase()),r.map(function(e,r){return c.default.createElement(d.View,{key:"".concat(t,"-").concat(r,"-").concat(e.text),style:P.sortedItemRow,__self:N,__source:{fileName:v,lineNumber:697,columnNumber:21}},c.default.createElement(d.Text,{style:P.sortedItemText,__self:N,__source:{fileName:v,lineNumber:701,columnNumber:23}},e.text),c.default.createElement(d.View,{style:[P.priorityBadge,(n=e.priority,"high"===n?P.priorityHigh:"medium"===n?P.priorityMedium:P.priorityLow)],__self:N,__source:{fileName:v,lineNumber:702,columnNumber:23}},c.default.createElement(d.Text,{style:P.priorityText,__self:N,__source:{fileName:v,lineNumber:708,columnNumber:25}},e.priority)));var n}))})),!$&&c.default.createElement(d.FlatList,{data:C,keyExtractor:function(e){return e.id},renderItem:function(e){var t=e.item;return c.default.createElement(d.View,{style:P.item,__self:N,__source:{fileName:v,lineNumber:492,columnNumber:5}},c.default.createElement(d.Text,{style:P.itemText,__self:N,__source:{fileName:v,lineNumber:493,columnNumber:7}},t.text),c.default.createElement(d.Pressable,{onPress:function(){return e=t.id,d.LayoutAnimation.configureNext(d.LayoutAnimation.Presets.easeInEaseOut),B(function(t){return t.filter(function(t){return t.id!==e})}),le([]),void oe(null);var e},accessibilityRole:"button",accessibilityLabel:"Delete brain dump item",accessibilityHint:"Removes this item from the list",style:function(e){var t=e.pressed,r=e.hovered;return[P.deleteButton,r&&P.deleteButtonHovered,t&&P.deleteButtonPressed]},hitSlop:A,__self:N,__source:{fileName:v,lineNumber:494,columnNumber:7}},c.default.createElement(d.Text,{style:P.deleteText,__self:N,__source:{fileName:v,lineNumber:512,columnNumber:9}},"√ó")))},keyboardShouldPersistTaps:"handled",keyboardDismissMode:"on-drag",initialNumToRender:10,maxToRenderPerBatch:10,updateCellsBatchingPeriod:50,windowSize:11,removeClippedSubviews:"android"===d.Platform.OS,contentContainerStyle:P.listContent,showsVerticalScrollIndicator:!1,ListEmptyComponent:c.default.createElement(d.View,{style:P.emptyState,__self:N,__source:{fileName:v,lineNumber:732,columnNumber:17}},c.default.createElement(d.Text,{style:P.emptyIcon,__self:N,__source:{fileName:v,lineNumber:733,columnNumber:19}},"‚òÅÔ∏è"),c.default.createElement(d.Text,{style:P.emptyText,__self:N,__source:{fileName:v,lineNumber:734,columnNumber:19}},"NULL_DATA."),c.default.createElement(d.View,{style:P.emptyAction,__self:N,__source:{fileName:v,lineNumber:735,columnNumber:19}},c.default.createElement(x.LinearButton,{title:"ADD FIRST ITEM",onPress:function(){var e;i.trim()?Ae():null===(e=he.current)||void 0===e||e.focus()},__self:N,__source:{fileName:v,lineNumber:736,columnNumber:21}}))),__self:N,__source:{fileName:v,lineNumber:718,columnNumber:13}}))))}},81731(e,t,r){var n=r(18772);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.RecordingService=void 0;var o,a,s,i,l=n(r(16578)),u=n(r(26007)),c=n(r(66593)),d=n(r(82857)),f=function(){try{var e;return null!==(e=r(59654).Audio)&&void 0!==e?e:null}catch(e){return null}},m=(0,d.default)(function e(){(0,c.default)(this,e),this.recording=null,this.isRecording=!1},[{key:"requestPermissions",value:(i=(0,u.default)(l.default.mark(function e(){var t,r,n,o;return l.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t=f()){e.next=1;break}return console.warn("Recording unavailable: expo-av is not installed"),e.abrupt("return",!1);case 1:return e.next=2,t.requestPermissionsAsync();case 2:return r=e.sent,n=r.status,e.abrupt("return","granted"===n);case 3:return e.prev=3,o=e.catch(0),console.error("Permission request failed:",o),e.abrupt("return",!1);case 4:case"end":return e.stop()}},e,null,[[0,3]])})),function(){return i.apply(this,arguments)})},{key:"startRecording",value:(s=(0,u.default)(l.default.mark(function e(){var t,r,n,o,a,s,i;return l.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isRecording){e.next=1;break}return console.warn("Already recording"),e.abrupt("return",!1);case 1:if(e.prev=1,n=f()){e.next=2;break}return console.warn("Recording unavailable: expo-av is not installed"),e.abrupt("return",!1);case 2:return e.next=3,this.requestPermissions();case 3:if(e.sent){e.next=4;break}return console.error("Microphone permission not granted"),e.abrupt("return",!1);case 4:return e.next=5,n.setAudioModeAsync({allowsRecordingIOS:!0,playsInSilentModeIOS:!0});case 5:return o=null!==(t=null===(r=n.RecordingOptionsPresets)||void 0===r?void 0:r.HIGH_QUALITY)&&void 0!==t?t:n.Recording.OptionsPresets.HIGH_QUALITY,e.next=6,n.Recording.createAsync(o);case 6:return a=e.sent,s=a.recording,this.recording=s,this.isRecording=!0,console.log("Recording started"),e.abrupt("return",!0);case 7:return e.prev=7,i=e.catch(1),console.error("Failed to start recording:",i),e.abrupt("return",!1);case 8:case"end":return e.stop()}},e,this,[[1,7]])})),function(){return s.apply(this,arguments)})},{key:"stopRecording",value:(a=(0,u.default)(l.default.mark(function e(){var t,r,n,o;return l.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.recording&&this.isRecording){e.next=1;break}return console.warn("No active recording"),e.abrupt("return",null);case 1:if(e.prev=1,t=f()){e.next=2;break}return console.warn("Recording unavailable: expo-av is not installed"),this.recording=null,this.isRecording=!1,e.abrupt("return",null);case 2:return e.next=3,this.recording.stopAndUnloadAsync();case 3:return e.next=4,t.setAudioModeAsync({allowsRecordingIOS:!1});case 4:return r=this.recording.getURI(),e.next=5,this.recording.getStatusAsync();case 5:if(n=e.sent,this.recording=null,this.isRecording=!1,r){e.next=6;break}return console.error("No recording URI"),e.abrupt("return",null);case 6:return console.log("Recording stopped:",r),e.abrupt("return",{uri:r,duration:n.durationMillis||0});case 7:return e.prev=7,o=e.catch(1),console.error("Failed to stop recording:",o),this.recording=null,this.isRecording=!1,e.abrupt("return",null);case 8:case"end":return e.stop()}},e,this,[[1,7]])})),function(){return a.apply(this,arguments)})},{key:"getIsRecording",value:function(){return this.isRecording}},{key:"cancelRecording",value:(o=(0,u.default)(l.default.mark(function e(){return l.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.recording){e.next=5;break}return e.prev=1,e.next=2,this.recording.stopAndUnloadAsync();case 2:e.next=4;break;case 3:e.prev=3,e.catch(1);case 4:this.recording=null,this.isRecording=!1;case 5:case"end":return e.stop()}},e,this,[[1,3]])})),function(){return o.apply(this,arguments)})},{key:"reset",value:function(){this.recording=null,this.isRecording=!1}}]),p=t.RecordingService=new m;t.default=p}}]);